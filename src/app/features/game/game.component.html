<div class="game-layout" [class.game-layout--empty]="!publicState()">
  <!-- Winner -->
  @if (winner(); as w) {
  <game-winner [winner]="w" [playerCount]="currentRoom()?.players?.length ?? publicState()?.players?.length ?? 0"
    (reset)="resetGame()" (leave)="leaveAfterWin()"></game-winner>
  }

  <!-- InformaciÃ³n de la partida -->
  @if (publicState(); as st) {
  <game-info [state]="st" [historyCount]="history().length" (historyRequested)="gameStore.openHistoryModal()"
    (leaveRequested)="gameStore.openLeaveModal()"></game-info>

  <!-- Tablero de la partida -->
  <game-board [state]="st" (startFailedExperiment)="handleFailedExperiment($event)"
    (startBodySwap)="handleBodySwap($event)" (startApparition)="handleApparition($event)"></game-board>

  <!-- Mano del jugador -->
  <game-hand [hand]="hand()" [isMyTurn]="isMyTurn()" [roomId]="roomId" [publicState]="st"
    [gameEnded]="isGameEnded()"></game-hand>
  }
  <!-- Home -->
  @else {
  <game-empty></game-empty>
  }

  @if (showHistory()) {
  <game-history [history]="history()" (closed)="gameStore.closeHistoryModal()"></game-history>
  }

  <!-- Errores -->
  <game-error [error]="lastError()" (closed)="dismissError()"></game-error>

  @if (showLeave()) {
  <game-leave (confirm)="gameStore.leaveGame(roomId)" (cancel)="gameStore.closeLeaveModal()"></game-leave>
  }
</div>