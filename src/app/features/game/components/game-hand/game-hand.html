<!-- <h3>Tu mano: {{ hand().length }} cartas</h3> -->

@if (hand().length) {
<div class="hand-panel" #handPanel [class.is-my-turn]="isMyTurn()">
  @if (selectedCard) {
  <game-target-select [selectedCard]="selectedCard" [targetOptions]="targetOptions"
    [contagionAssignments]="contagionAssignments" [publicState]="publicState()" [selectedTarget]="selectedTarget"
    [selectedTargetA]="selectedTargetA" [selectedTargetB]="selectedTargetB" [confirmDisabled]="!canConfirmSelection"
    [selectedAction]="selectedActionForFailedExperiment" [isMyTurn]="isMyTurn()" [isDragDrop]="isDragDropSelection"
    [selectedDirection]="selectedDirection" (targetChange)="onTargetChange($event.value, $event.which)"
    (contagionTargetChange)="onContagionTargetChange($event.value, $event.index)"
    (actionChange)="selectedActionForFailedExperiment = $event" (directionChange)="onDirectionChange($event)"
    (confirm)="confirmPlayCard()" (cancel)="clearSelection()" />
  }

  @if (mustPlayCardId()) {
  <div class="apparition-banner">
    <p>ðŸ‘» Â¡Has jugado ApariciÃ³n!</p>
    <p>Debes <strong class="highlight-action">jugar la nueva carta</strong> o <strong
        class="highlight-action">conservarla</strong>.</p>
    <button (click)="keepApparitionCard()" class="keep-btn">
      Conservar carta y Pasar Turno
    </button>
  </div>
  }

  <div class="hand-container" [class.is-my-turn]="isMyTurn()" cdkDropList
    [id]="'handList-' + (apiPlayer.player()?.id || '')" [cdkDropListData]="hand()" [cdkDropListConnectedTo]="boardIds()"
    (cdkDropListExited)="onExitHand($event)">
    @for (card of hand(); track card.id) {
    <app-hand-card [card]="card" [isSelected]="isCardSelected(card)" [isMyTurn]="isMyTurn()"
      [infoOpen]="selectedCard?.id === card.id" [isDisabled]="mustPlayCardId() !== null && mustPlayCardId() !== card.id"
      (toggleSelect)="toggleDiscardSelection($event)" (play)="selectCardToPlay($event)"></app-hand-card>
    }
  </div>

  @if (selectedDiscardCount()) {
  <button class="discard-btn" (click)="discardSelectedCards()"
    [disabled]="!isMyTurn() || !selectedDiscardCount() || gameEnded()">
    Descartar seleccionadas ({{ selectedDiscardCount() }})
  </button>
  }
</div>
<div class="hand-panel-spacer" aria-hidden="true" [style.height.px]="panelSpacerHeight"></div>
<!-- Jugador no tiene cartas -->
} @else {
<div class="hand-empty">
  <p>Sin cartas</p>
</div>
}