@if (contagionAssignments().length) {
@for (assignment of contagionAssignments(); let i = $index; track i) {
<section class="target-select__group target-select__group--with-organs target-select__contagion-block">
  <div class="target-select__field target-select__field--player" [class.is-active]="!!assignment.toPlayerId">
    <div class="target-select__label-container">
      <span class="target-select__label-main">
        <span class="target-select__label-icon" aria-hidden="true">ðŸ‘¤</span>
        <span>{{ contagionVirusLabel(assignment) }}</span>
      </span>
      <span>{{ contagionSourceLabel(assignment) }}</span>
    </div>
    <div class="target-select__players">
      @for (player of contagionPlayerOptions; track player.id) {
      <button type="button" class="target-select__player" [class.is-active]="assignment.toPlayerId === player.id"
        (click)="handleContagionPlayerChange(player.id, i)">
        <span class="target-select__player-icon">ðŸ‘¤</span>
        <span>{{ player.name | titlecase }}</span>
      </button>
      }
    </div>
  </div>

  <div class="target-select__field target-select__field--organs" [class.is-active]="!!assignment.toOrganId"
    [class.is-disabled]="!assignment.toPlayerId">
    <label>
      <span class="target-select__label-main">
        <span class="target-select__label-icon" aria-hidden="true">ðŸ«€</span>
        <span>Ã“rgano destino</span>
      </span>
    </label>
    @let organs = contagionOrgansForPlayer(assignment.toPlayerId);
    @if (
    assignment.toPlayerId &&
    organs.length
    ) {
    <div class="target-select__organs">
      @for (opt of organs; track opt.organId) {
      <button type="button" class="target-select__organ"
        [class.is-active]="contagionSelectionValue(assignment) === toOptionValue(opt)"
        (click)="selectContagionOrgan(opt, i)">
        <span class="color-dot" [ngClass]="organColorClass(opt.organColor)"></span>
        <span>{{ organColorLabel(opt.organColor) }}</span>
      </button>
      }
    </div>
    } @else if (assignment.toPlayerId) {
    <p class="target-select__empty target-select__empty--inline">
      Ese jugador no tiene Ã³rganos libres.
    </p>
    } @else {
    <p class="target-select__empty target-select__empty--inline">
      Selecciona primero un jugador.
    </p>
    }
  </div>
</section>
}
} @else {
<p class="target-select__empty">
  No tienes virus disponibles para contagiar.
</p>
}