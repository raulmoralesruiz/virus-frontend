<div
  class="game-info"
  [class.game-info--expanded]="showDetails"
  (click)="toggleDetails()"
  (keydown)="onKeyDown($event)"
  role="button"
  tabindex="0"
  [attr.aria-expanded]="showDetails"
>
  <div class="game-info__header">
    <h2>Partida {{ shortRoomId }}</h2>
    <div class="game-info__actions">
      <button
        type="button"
        class="theme-toggle"
        (click)="onToggleTheme($event)"
        [attr.aria-pressed]="isDarkTheme()"
      >
        {{ isDarkTheme() ? "☀️" : "🌙" }}
      </button>
      <button
        type="button"
        class="history-toggle"
        (click)="onHistoryClick($event)"
      >
        Historial @if (historyCount) {
        <span class="history-badge">{{ historyCount }}</span>
        }
      </button>
    </div>
  </div>

  @if (showDetails) {
  <div class="game-info__details">
    <div class="game-info__summary">
      <div
        class="game-info__pile game-info__pile--start"
        role="group"
        [attr.aria-label]="'Hora de inicio: ' + (state.startedAt | date : 'HH:mm')"
      >
        <span class="game-info__pile-icon game-info__pile-icon--start" aria-hidden="true">
          <span class="game-info__pile-count">{{ state.startedAt | date : 'HH:mm' }}</span>
        </span>
        <span class="game-info__pile-label">Inicio</span>
      </div>
      <div
        class="game-info__pile"
        role="group"
        [attr.aria-label]="'Cartas en el mazo: ' + state.deckCount"
      >
        <span class="game-info__pile-icon game-info__pile-icon--deck" aria-hidden="true">
          <span class="game-info__pile-count">{{ state.deckCount }}</span>
        </span>
        <span class="game-info__pile-label">Mazo</span>
      </div>
      <div
        class="game-info__pile"
        role="group"
        [attr.aria-label]="'Cartas en el descarte: ' + state.discardCount"
      >
        <span class="game-info__pile-icon game-info__pile-icon--discard" aria-hidden="true">
          <span class="game-info__pile-count">{{ state.discardCount }}</span>
        </span>
        <span class="game-info__pile-label">Descarte</span>
      </div>
    </div>
    <div class="game-info__controls">
      <button
        type="button"
        class="game-info__leave"
        (click)="onLeaveClick($event)"
      >
        Salir de la partida
      </button>
      <button
        type="button"
        class="fullscreen-toggle"
        (click)="onToggleFullscreen($event)"
        [attr.aria-pressed]="isFullscreenActive"
      >
        {{ isFullscreenActive ? "📱" : "🖥️" }}
      </button>
      <button
        type="button"
        class="sound-toggle"
        (click)="onToggleMute($event)"
        [attr.aria-pressed]="isMuted()"
      >
        {{ isMuted() ? "🔊" : "🔇" }}
      </button>
    </div>
  </div>
  }
</div>
